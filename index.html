<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>User Form</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        form { max-width: 400px; margin: auto; padding: 20px; border: 1px solid #ddd; border-radius: 8px; }
        label { display: block; margin-bottom: 8px; font-weight: bold; }
        input, textarea { width: 100%; padding: 8px; margin-bottom: 16px; border: 1px solid #ddd; border-radius: 4px; }
        button { padding: 10px 15px; background: #007BFF; color: white; border: none; border-radius: 4px; cursor: pointer; }
        button:hover { background: #0056b3; }
    </style>
    <script>
        async function submitData(event) {
            event.preventDefault();

            const name = document.getElementById("name").value;
            const email = document.getElementById("email").value;
            const message = document.getElementById("message").value;

            const newData = {
                name,
                email,
                message,
                timestamp: new Date().toISOString(),
            };

            const owner = "your-github-username";
            const repo = "your-repo-name";
            const filePath = "data/users.json";
            const token = "your-personal-access-token";

            // Fetch existing data
            const fileResponse = await fetch(`https://api.github.com/repos/${owner}/${repo}/contents/${filePath}`, {
                headers: {
                    Authorization: `token ${token}`,
                },
            });

            if (!fileResponse.ok) {
                alert("Error fetching data from GitHub.");
                return;
            }

            const fileData = await fileResponse.json();
            const existingData = JSON.parse(atob(fileData.content));

            // Append new data
            existingData.push(newData);

            // Update file in GitHub
            const updateResponse = await fetch(`https://api.github.com/repos/${owner}/${repo}/contents/${filePath}`, {
                method: "PUT",
                headers: {
                    Authorization: `token ${token}`,
                    "Content-Type": "application/json",
                },
                body: JSON.stringify({
                    message: "Add new user data",
                    content: btoa(JSON.stringify(existingData, null, 2)),
                    sha: fileData.sha,
                }),
            });

            if (updateResponse.ok) {
                alert("Data submitted successfully!");
                document.getElementById("userForm").reset();
            } else {
                alert("Error saving data to GitHub.");
            }
        }
    </script>
</head>
<body>
    <form id="userForm" onsubmit="submitData(event)">
        <h2>Submit Your Details</h2>
        <label for="name">Name:</label>
        <input type="text" id="name" name="name" placeholder="Your Name" required>
        
        <label for="email">Email:</label>
        <input type="email" id="email" name="email" placeholder="Your Email" required>
        
        <label for="message">Message:</label>
        <textarea id="message" name="message" rows="5" placeholder="Your Message" required></textarea>
        
        <button type="submit">Submit</button>
    </form>
</body>
</html>
